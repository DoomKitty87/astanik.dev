<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ansel Stanik</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="" />
  <link rel="icon" href="favicon.png">
  <svg>
    <filter id="noise">
      <feTurbulence
        type="turbulence"
        baseFrequency="0.0015"
        numOctaves="2"
        result="noisetexture"
      />
      <feColorMatrix
        type="saturate"
        values="0.2"
        in="noisetexture"
        result="desat"/>
      <feBlend 
        in="desat"
        in2="SourceGraphic"
        mode="normal"
      />
    </filter>
  </svg>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="background" id="background"></div>
  <div class="namecontainer" id="namecontainer">
    <h1 class="nametitle" id="nametext">ansel</h1>
    <h2 class="namesubtitle" id="namesub">stanik</h2>
  </div>
  <div class="decorativeblock" id="decoration"></div>
  <div class="menubuttons">
    <h3 data-active="false" class="menubutton" onclick="openPanel(0)">work</h3>
    <h3 data-active="false" class="menubutton" onclick="openPanel(1)">about</h3>
    <h3 data-active="false" class="menubutton" onclick="openPanel(2)">skills</h3>
    <h3 data-active="false" class="menubutton" onclick="openPanel(3)">contact</h3>
  </div>
  <div class="popupholder" id="popupholder">
  <div class="popupdisplay">
    <h1 class="titletext">things i did</h1>
  </div>
  <div class="popupdisplay" id="popupholder">
    <h1 class="titletext">about me</h1>
    <p class="bodytext">i am a high school junior based in oregon who likes computers and other cool things</p>
  </div>
  <div class="popupdisplay">
    <h1 class="titletext">things i can do</h1>
  </div>
  <div class="popupdisplay">
    <h1 class="titletext">contact me</h1>
    <p class="bodytext">email: <a href="" class="contactlink" id="emailtext"></a></p>
  </div>
  </div>
  <script>
    document.getElementById('emailtext').innerHTML = 'ansel.' + 'stanik' + '@' + 'icloud.com';
    document.getElementById('emailtext').href = 'mailto:' + 'ansel.' + 'stanik' + '@' + 'icloud.com';
    const name = document.getElementById('nametext');
    const last = document.getElementById('namesub');
    const nameContainer = document.getElementById('namecontainer');
    const decorativeBlock = document.getElementById('decoration');
    const popupHolder = document.getElementById('popupholder');
    const bound = name.getBoundingClientRect();
    const bound2 = last.getBoundingClientRect();
    const bound3 = decorativeBlock.getBoundingClientRect();
    const panelSizes = [32, 5, 25, 6, 20, 4, 13.5, 2.3];
    const background = document.getElementById('background');
    async function openPanel(panel) {
      var panels = document.getElementsByClassName('popupdisplay');
      var buttons = document.getElementsByClassName('menubutton');
      var foundActive = 0;
      var waitingForTransition = false;
      for (var i = 0; i < buttons.length; i++) {
        if (buttons[i].dataset.active == 'true') foundActive++;
      }
      if (!foundActive) {
        popupHolder.style.transition = "none";
        popupHolder.style.setProperty("left", -panelSizes[panel * 2].toString() + "em");
        popupHolder.offsetHeight;
        popupHolder.style.transition = "";
      }
      if (foundActive == 1 && buttons[panel].dataset.active == 'true') {
        popupHolder.style.setProperty("left", -panelSizes[panel * 2].toString() + "em");
        waitingForTransition = true;
      }
      else {
        for (var i = 0; i < panels.length; i++) {
          panels[i].style.display = 'none'
        }
      }

      if (buttons[panel].dataset.active == 'false') buttons[panel].dataset.active = 'true';
      else buttons[panel].dataset.active = 'false';
      for (var i = 0; i < buttons.length; i++) {
        if (i == panel) continue;
        buttons[i].dataset.active = 'false';
      }
      nameContainer.style.setProperty("bottom", 0);
      decorativeBlock.style.setProperty("right", 0);
      if (waitingForTransition) {
        await new Promise(r => setTimeout(r, 500));
        panels[panel].style.display = 'none';
      }
      if (buttons[panel].dataset.active == 'false') return;
      nameContainer.style.setProperty("bottom", (bound.top - bound.bottom).toString() + "px");
      decorativeBlock.style.setProperty("right", (bound3.left - bound3.right).toString() + "px");
      popupHolder.style.setProperty("width", panelSizes[panel * 2].toString() + "em");
      popupHolder.style.setProperty("height", panelSizes[panel * 2 + 1].toString() + "em");
      popupHolder.style.setProperty("left", 0);
      panels[panel].style.display = 'block';
    }
    document.addEventListener("mousemove", event => {
      name.style.setProperty("background-position-x", (event.clientX - bound.left - (bound.right - bound.left) * 5).toString() + "px");
      name.style.setProperty("background-position-y", (event.clientY - bound.top - (bound.bottom - bound.top) * 5).toString() + "px");
      last.style.setProperty("background-position-x", (event.clientX - bound2.left - (bound2.right - bound2.left) * 10).toString() + "px");
      last.style.setProperty("background-position-y", (event.clientY - bound2.top - (bound2.bottom - bound2.top) * 10).toString() + "px");
    });
  </script>
</body>
</html>